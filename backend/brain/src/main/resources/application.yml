spring:
  application:
    name: kodama-brain
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:kodama}?useSSL=false&allowPublicKeyRetrieval=true}
    username: ${SPRING_DATASOURCE_USERNAME:${DB_USERNAME:kodama}}
    password: ${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:kodama}}
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        jdbc:
          time_zone: UTC+2
  flyway:
    enabled: true
    locations: ${SPRING_FLYWAY_LOCATIONS:classpath:db/migration}

node:
  heartbeat-interval-seconds: ${NODE_HEARTBEAT_INTERVAL_SECONDS:30}
  heartbeat-timeout-seconds: ${NODE_HEARTBEAT_TIMEOUT_SECONDS:90}
  heartbeat-monitor-interval-seconds: ${NODE_HEARTBEAT_MONITOR_INTERVAL_SECONDS:60}
  command-timeout-seconds: ${NODE_COMMAND_TIMEOUT_SECONDS:10}
  command-max-attempts: ${NODE_COMMAND_MAX_ATTEMPTS:2}
  command-retry-backoff-millis: ${NODE_COMMAND_RETRY_BACKOFF_MILLIS:500}

instance:
  stale-detection:
    enabled: ${INSTANCE_STALE_DETECTION_ENABLED:true}
    monitor-interval-seconds: ${INSTANCE_STALE_DETECTION_INTERVAL_SECONDS:60}
    preparing-timeout-seconds: ${INSTANCE_PREPARING_TIMEOUT_SECONDS:300}
    starting-timeout-seconds: ${INSTANCE_STARTING_TIMEOUT_SECONDS:300}

brain:
  security:
    enabled: ${BRAIN_SECURITY_ENABLED:true}
    jwt:
      issuer: ${BRAIN_JWT_ISSUER:kodama-brain}
      secret: ${BRAIN_JWT_SECRET:}
      token-ttl-seconds: ${BRAIN_JWT_TTL_SECONDS:3600}
    node:
      token: ${BRAIN_NODE_AUTH_TOKEN:}
      header-name: ${BRAIN_NODE_AUTH_HEADER_NAME:X-Node-Token}
    users:
      - username: ${BRAIN_ADMIN_USERNAME:admin}
        display-name: ${BRAIN_ADMIN_DISPLAY_NAME:Admin}
        email: ${BRAIN_ADMIN_EMAIL:admin@example.com}
        password: ${BRAIN_ADMIN_PASSWORD:}
        roles: ADMIN

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always
      show-components: always
